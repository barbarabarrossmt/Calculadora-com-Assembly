
/ --- Programa Principal ---
Start,          Load MenuTxt
                 Store Menu
                 Load MsgNum1Txt
                 Store MsgNum1
                 Load MsgNum2Txt
                 Store MsgNum2
                 Load MsgResultTxt
                 Store MsgResult
                 Load MsgErroTxt
                 Store MsgErro
                 Load MsgDivZeroTxt
                 Store MsgDivZero

MainLoop,       JnS ExibirMenu    / Exibir menu
                 JnS LerOpcao      / Ler opção do usuário
                 
                 / Verificar se é sair (opção 5)
                 Load Opcao
                 Subt Cinco
                 Skipcond 400      / Se zero, pular próxima instrução
                 Jump VerificaOpcoes
                 Jump Sair
                 
VerificaOpcoes, Load Opcao
                 Subt Um
                 Skipcond 400      / Se zero, é opção 1
                 Jump CheckOp2
                 Jump LerNumerosSoma
                 
CheckOp2,       Load Opcao
                 Subt Dois
                 Skipcond 400      / Se zero, é opção 2
                 Jump CheckOp3
                 Jump LerNumerosSub
                 
CheckOp3,       Load Opcao
                 Subt Tres
                 Skipcond 400      / Se zero, é opção 3
                 Jump CheckOp4
                 Jump LerNumerosMult
                 
CheckOp4,       Load Opcao
                 Subt Quatro
                 Skipcond 400      / Se zero, é opção 4
                 Jump OpcaoInvalida / Se chegou aqui, opção inválida
                 Jump LerNumerosDiv

/ --- Fluxos das operações ---
LerNumerosSoma, JnS LerNumeros
                 JnS Somar
                 Jump MainLoop
                 
LerNumerosSub,  JnS LerNumeros
                 JnS Subtrair
                 Jump MainLoop
                 
LerNumerosMult, JnS LerNumeros
                 JnS Multiplicar
                 Jump MainLoop
                 
LerNumerosDiv,  JnS LerNumeros
                 JnS Dividir
                 Jump MainLoop

/ --- Sub-rotinas ---

/ Exibir Menu
ExibirMenu,     HEX 0
                 Load Menu         / Carregar endereço do menu
                 Store PrintAddr   / Armazenar para impressão
                 JnS PrintString   / Chamar sub-rotina de impressão
                 JumpI ExibirMenu

/ Ler Opção
LerOpcao,       HEX 0
                 Input             / Ler caractere
                 Store Opcao
                 Subt AsciiOffset  / Converter ASCII para número
                 Store Opcao
                 
                 / Limpar buffer de entrada (ler newline)
                 Input
                 
                 JumpI LerOpcao

/ Ler Números
LerNumeros,     HEX 0
                 / Pedir primeiro número
                 Load MsgNum1
                 Store PrintAddr
                 JnS PrintString
                 
                 / Ler primeiro número
                 Input
                 Store Num1
                 Subt AsciiOffset  / Converter ASCII para número
                 Store Num1
                 
                 / Pedir segundo número
                 Load MsgNum2
                 Store PrintAddr
                 JnS PrintString
                 
                 / Ler segundo número
                 Input
                 Store Num2
                 Subt AsciiOffset  / Converter ASCII para número
                 Store Num2
                 
                 JumpI LerNumeros

/ Operação de Soma
Somar,          HEX 0
                 Load Num1
                 Add Num2
                 Store Resultado
                 JnS ExibirResultado
                 JumpI Somar

/ Operação de Subtração
Subtrair,       HEX 0
                 Load Num1
                 Subt Num2
                 Store Resultado
                 JnS ExibirResultado
                 JumpI Subtrair

/ Operação de Multiplicação
Multiplicar,    HEX 0
                 Load Zero
                 Store Resultado
                 Load Num2
                 Store Temp
                 
MultiLoop,      Load Temp
                 Skipcond 400      / Se zero, terminar
                 Jump MultiFim
                 
                 Load Resultado
                 Add Num1
                 Store Resultado
                 
                 Load Temp
                 Subt Um
                 Store Temp
                 
                 Jump MultiLoop
                 
MultiFim,       JnS ExibirResultado
                 JumpI Multiplicar

/ Operação de Divisão
Dividir,        HEX 0
                 Load Num2
                 Skipcond 400      / Se zero, erro divisão por zero
                 Jump DivContinua
                 Jump DivZeroErro
                 
DivContinua,    Load Zero
                 Store Resultado
                 Load Num1
                 Store Temp
                 
DivLoop,        Load Temp
                 Subt Num2
                 Skipcond 800      / Se negativo, terminar
                 Jump DivFim
                 
                 Store Temp
                 Load Resultado
                 Add Um
                 Store Resultado
                 
                 Jump DivLoop
                 
DivFim,         JnS ExibirResultado
                 JumpI Dividir

/ Exibir Resultado
ExibirResultado, HEX 0
                 Load MsgResult
                 Store PrintAddr
                 JnS PrintString
                 
                 / Converter número para ASCII e exibir
                 Load Resultado
                 Add AsciiOffset
                 Output
                 
                 / Nova linha
                 Load NewLine
                 Store PrintAddr
                 JnS PrintString
                 
                 JumpI ExibirResultado

/ Sub-rotina para imprimir string
PrintString,    HEX 0
                 LoadI PrintAddr   / Carregar caractere atual
                 Skipcond 400      / Se zero, terminar
                 Jump PrintFim
                 
                 Output            / Imprimir caractere
                 
                 / Próximo caractere
                 Load PrintAddr
                 Add Um
                 Store PrintAddr
                 
                 Jump PrintString
                 
PrintFim,       JumpI PrintString

/ Tratamento de erros
OpcaoInvalida,  Load MsgErro
                 Store PrintAddr
                 JnS PrintString
                 Jump MainLoop

DivZeroErro,    Load MsgDivZero
                 Store PrintAddr
                 JnS PrintString
                 Jump MainLoop

/ --- Sair do programa ---
Sair,           Halt

/ --- Variáveis da sub-rotina de impressão ---
PrintAddr,      DEC 0

/ --- Constantes numéricas ---
Zero,           DEC 0
Um,             DEC 1
Dois,           DEC 2
Tres,           DEC 3
Quatro,         DEC 4
Cinco,          DEC 5
AsciiOffset,    DEC 48    / Para converter entre número e ASCII ('0' = 48)

/ --- Variáveis do programa ---
Opcao,      DEC 0
Num1,       DEC 0
Num2,       DEC 0
Resultado,  DEC 0
Temp,       DEC 0

/ --- Ponteiros para strings ---
Menu,        HEX 0
MsgNum1,     HEX 0
MsgNum2,     HEX 0
MsgResult,   HEX 0
MsgErro,     HEX 0
MsgDivZero,  HEX 0

/ --- Strings do Menu ---
MenuTxt,        DEC 10     / \n
                 DEC 61     / =
                 DEC 61     / =
                 DEC 61     / =
                 DEC 32     / espaço
                 DEC 67     / C
                 DEC 65     / A
                 DEC 76     / L
                 DEC 67     / C
                 DEC 85     / U
                 DEC 76     / L
                 DEC 65     / A
                 DEC 68     / D
                 DEC 79     / O
                 DEC 82     / R
                 DEC 65     / A
                 DEC 32     / espaço
                 DEC 61     / =
                 DEC 61     / =
                 DEC 61     / =
                 DEC 10     / \n
                 DEC 49     / 1
                 DEC 46     / .
                 DEC 32     / espaço
                 DEC 83     / S
                 DEC 79     / O
                 DEC 77     / M
                 DEC 65     / A
                 DEC 10     / \n
                 DEC 50     / 2
                 DEC 46     / .
                 DEC 32     / espaço
                 DEC 83     / S
                 DEC 85     / U
                 DEC 66     / B
                 DEC 84     / T
                 DEC 82     / R
                 DEC 65     / A
                 DEC 67     / C
                 DEC 65     / A
                 DEC 79     / O
                 DEC 10     / \n
                 DEC 51     / 3
                 DEC 46     / .
                 DEC 32     / espaço
                 DEC 77     / M
                 DEC 85     / U
                 DEC 76     / L
                 DEC 84     / T
                 DEC 73     / I
                 DEC 80     / P
                 DEC 76     / L
                 DEC 73     / I
                 DEC 67     / C
                 DEC 65     / A
                 DEC 67     / C
                 DEC 65     / A
                 DEC 79     / O
                 DEC 10     / \n
                 DEC 52     / 4
                 DEC 46     / .
                 DEC 32     / espaço
                 DEC 68     / D
                 DEC 73     / I
                 DEC 86     / V
                 DEC 73     / I
                 DEC 83     / S
                 DEC 65     / A
                 DEC 79     / O
                 DEC 10     / \n
                 DEC 53     / 5
                 DEC 46     / .
                 DEC 32     / espaço
                 DEC 83     / S
                 DEC 65     / A
                 DEC 73     / I
                 DEC 82     / R
                 DEC 10     / \n
                 DEC 69     / E
                 DEC 115    / s
                 DEC 99     / c
                 DEC 111    / o
                 DEC 108    / l
                 DEC 104    / h
                 DEC 97     / a
                 DEC 32     / espaço
                 DEC 117    / u
                 DEC 109    / m
                 DEC 97     / a
                 DEC 32     / espaço
                 DEC 111    / o
                 DEC 112    / p
                 DEC 99     / c
                 DEC 97     / a
                 DEC 111    / o
                 DEC 58     / :
                 DEC 32     / espaço
                 DEC 0      / null terminator

MsgNum1Txt,     DEC 10     / \n
                 DEC 68     / D
                 DEC 105    / i
                 DEC 103    / g
                 DEC 105    / i
                 DEC 116    / t
                 DEC 101    / e
                 DEC 32     / espaço
                 DEC 111    / o
                 DEC 32     / espaço
                 DEC 112    / p
                 DEC 114    / r
                 DEC 105    / i
                 DEC 109    / m
                 DEC 101    / e
                 DEC 105    / i
                 DEC 114    / r
                 DEC 111    / o
                 DEC 32     / espaço
                 DEC 110    / n
                 DEC 117    / u
                 DEC 109    / m
                 DEC 101    / e
                 DEC 114    / r
                 DEC 111    / o
                 DEC 58     / :
                 DEC 32     / espaço
                 DEC 0      / null terminator

MsgNum2Txt,     DEC 68     / D
                 DEC 105    / i
                 DEC 103    / g
                 DEC 105    / i
                 DEC 116    / t
                 DEC 101    / e
                 DEC 32     / espaço
                 DEC 111    / o
                 DEC 32     / espaço
                 DEC 115    / s
                 DEC 101    / e
                 DEC 103    / g
                 DEC 117    / u
                 DEC 110    / n
                 DEC 100    / d
                 DEC 111    / o
                 DEC 32     / espaço
                 DEC 110    / n
                 DEC 117    / u
                 DEC 109    / m
                 DEC 101    / e
                 DEC 114    / r
                 DEC 111    / o
                 DEC 58     / :
                 DEC 32     / espaço
                 DEC 0      / null terminator

MsgResultTxt,   DEC 10     / \n
                 DEC 82     / R
                 DEC 101    / e
                 DEC 115    / s
                 DEC 117    / u
                 DEC 108    / l
                 DEC 116    / t
                 DEC 97     / a
                 DEC 100    / d
                 DEC 111    / o
                 DEC 58     / :
                 DEC 32     / espaço
                 DEC 0      / null terminator

MsgErroTxt,     DEC 10     / \n
                 DEC 79     / O
                 DEC 112    / p
                 DEC 99     / c
                 DEC 97     / a
                 DEC 111    / o
                 DEC 32     / espaço
                 DEC 105    / i
                 DEC 110    / n
                 DEC 118    / v
                 DEC 97     / a
                 DEC 108    / l
                 DEC 105    / i
                 DEC 100    / d
                 DEC 97     / a
                 DEC 33     / !
                 DEC 10     / \n
                 DEC 0      / null terminator

MsgDivZeroTxt,  DEC 10     / \n
                 DEC 69     / E
                 DEC 114    / r
                 DEC 114    / r
                 DEC 111    / o
                 DEC 58     / :
                 DEC 32     / espaço
                 DEC 68     / D
                 DEC 105    / i
                 DEC 118    / v
                 DEC 105    / i
                 DEC 115    / s
                 DEC 97     / a
                 DEC 111    / o
                 DEC 32     / espaço
                 DEC 112    / p
                 DEC 111    / o
                 DEC 114    / r
                 DEC 32     / espaço
                 DEC 122    / z
                 DEC 101    / e
                 DEC 114    / r
                 DEC 111    / o
                 DEC 33     / !
                 DEC 10     / \n
                 DEC 0      / null terminator

NewLine,        DEC 10     / \n
                 DEC 0      / null terminator

END Start
